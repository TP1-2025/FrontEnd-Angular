@if (!rows || rows.length === 0) {
  <p>No hay registros para mostrar.</p>
} @else {
  <div class="table-wrapper">

    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z1">

      <!-- Periodo -->
      <ng-container matColumnDef="NUMPERIODO">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Periodo</th>
        <td mat-cell *matCellDef="let row">{{ row.NUMPERIODO ?? '-' }}</td>
      </ng-container>

      <!-- Cliente -->
      <ng-container matColumnDef="cliente">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Cliente</th>
        <td mat-cell *matCellDef="let row">
          {{ row.id_cst ?? row.codigo_cliente ?? '-' }}
        </td>
      </ng-container>

      <!-- Número -->
      <ng-container matColumnDef="numero">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Número</th>
        <td mat-cell *matCellDef="let row">
          {{ maskNumero(row.numero) }}
        </td>
      </ng-container>

      <!-- Probabilidad -->
      <ng-container matColumnDef="probabilidad">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Probabilidad</th>
        <td mat-cell *matCellDef="let row">
          {{ (row.probabilidad_portabilidad * 100) | number : '1.1-1' }}%
        </td>
      </ng-container>

      <!-- Nivel Riesgo -->
      <ng-container matColumnDef="nivel_riesgo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Riesgo</th>
        <td mat-cell *matCellDef="let row">{{ row.nivel_riesgo ?? '-' }}</td>
      </ng-container>

      <!-- Cluster -->
      <ng-container matColumnDef="cluster">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Cluster</th>
        <td mat-cell *matCellDef="let row">
          {{ row.cluster_id ?? '-' }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <mat-paginator
      [pageSize]="10"
      [pageSizeOptions]="[5, 10, 25, 50]"
      showFirstLastButtons
    ></mat-paginator>

  </div>
}
